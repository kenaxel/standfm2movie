# スタエフ音声から動画生成アプリ 要件定義書

## 1. プロジェクト概要

### 1.1 目的
stand.fmの音声コンテンツから自動的に動画を生成し、YouTube（横長）とTikTok（縦長）向けの動画を作成するWebアプリケーション。

### 1.2 背景
- 現在vrewを使用して手動で動画作成を行っている
- より安価で自動化された動画生成ソリューションが必要
- 複数のフォーマット（YouTube、TikTok）に対応したい

### 1.3 目標
- 音声から自動的に動画を生成
- コスト効率の良いソリューション
- 簡単な操作で高品質な動画を作成

## 2. 機能要件

### 2.1 入力機能
- **音声入力**（既存機能を再利用）
  - stand.fmのURL入力
  - 音声ファイルアップロード（mp3, mp4, m4a, wav対応）
  - ファイルサイズ制限: 25MB

### 2.2 音声処理機能
- **文字起こし**（既存機能を再利用）
  - OpenAI Whisperによる自動文字起こし
  - 高精度な日本語音声認識

### 2.3 動画生成機能（新規開発）
- **動画フォーマット**
  - YouTube用: 横長（16:9、1920x1080）
  - TikTok用: 縦長（9:16、1080x1920）× 2パターン

- **動画コンテンツ**
  - 音声に合わせた視覚的要素の自動挿入
    - 関連する図表・イラスト
    - ストック動画素材
    - テキストアニメーション
  - 自動キャプション生成
    - 音声と同期したテキスト表示
    - 読みやすいフォントとサイズ
    - 背景との適切なコントラスト

### 2.4 カスタマイズ機能
- **動画設定**
  - テーマカラー選択
  - フォントスタイル選択
  - ロゴ・ブランディング要素の追加
  - BGM選択（オプション）

- **コンテンツ設定**
  - キーワード指定（関連画像・動画検索用）
  - ターゲット層設定
  - 動画の雰囲気・トーン設定

### 2.5 出力機能
- **動画エクスポート**
  - MP4形式での出力
  - 高品質（1080p）対応
  - 圧縮オプション

- **プレビュー機能**
  - 生成前のプレビュー表示
  - 編集・調整機能

## 3. 非機能要件

### 3.1 性能要件
- 音声ファイル（5分程度）の処理時間: 10分以内
- 同時処理可能ユーザー数: 10人
- アップロード可能ファイルサイズ: 25MB

### 3.2 品質要件
- 動画品質: 1080p（フルHD）
- 音声品質: 元音声と同等
- キャプション精度: 95%以上

### 3.3 コスト要件
- vrewより安価な運用コスト
- 従量課金制のAPI使用を最適化
- 無料素材の積極活用

### 3.4 ユーザビリティ要件
- 直感的なUI/UX
- 3ステップ以内での動画生成
- レスポンシブデザイン対応

## 4. 技術要件

### 4.1 再利用可能な既存技術
- **フロントエンド**: Next.js 14 + React + TypeScript + Tailwind CSS
- **音声処理**: OpenAI Whisper API
- **ファイルアップロード**: react-dropzone + multer
- **UI コンポーネント**: AudioUpload, SettingsForm（一部改修）

### 4.2 新規導入技術（候補）
- **動画生成ライブラリ**
  - FFmpeg（サーバーサイド動画処理）
  - Canvas API（ブラウザベース動画生成）
  - Remotion（React-based動画生成）
  - Fabric.js（動的グラフィック生成）

- **素材取得API**
  - Unsplash API（無料画像）
  - Pexels API（無料動画・画像）
  - Pixabay API（無料素材）

- **AI画像生成**
  - OpenAI DALL-E 3（カスタム画像生成）
  - Stable Diffusion（オープンソース画像生成）

### 4.3 インフラ要件
- **ホスティング**: Vercel（既存と同様）
- **ストレージ**: 一時ファイル保存用（動画生成中）
- **CDN**: 動画配信最適化

## 5. システム構成

### 5.1 アーキテクチャ概要
```
[フロントエンド]
├── 音声アップロード（既存）
├── 動画設定フォーム（新規）
├── プレビュー画面（新規）
└── ダウンロード画面（新規）

[バックエンド API]
├── /api/transcribe（既存）
├── /api/generate-video（新規）
├── /api/get-assets（新規）
└── /api/export-video（新規）

[外部サービス]
├── OpenAI（Whisper, DALL-E）
├── 素材提供API（Unsplash, Pexels）
└── 動画処理サービス
```

### 5.2 データフロー
1. 音声ファイル/URL入力
2. 文字起こし実行（既存機能）
3. コンテンツ解析・キーワード抽出
4. 関連素材検索・取得
5. 動画構成設計
6. 動画生成・レンダリング
7. プレビュー表示
8. 最終動画エクスポート

## 6. 開発計画

### 6.1 フェーズ1: 基盤構築（1-2週間）
- 技術選定と環境構築
- 既存コードの改修・拡張
- 基本的な動画生成機能の実装

### 6.2 フェーズ2: コア機能開発（2-3週間）
- 自動素材選択機能
- キャプション生成・同期機能
- 複数フォーマット対応

### 6.3 フェーズ3: 品質向上（1-2週間）
- UI/UX改善
- パフォーマンス最適化
- テスト・デバッグ

### 6.4 フェーズ4: 運用準備（1週間）
- デプロイ準備
- ドキュメント整備
- 運用監視設定

## 7. リスクと対策

### 7.1 技術リスク
- **動画生成処理の重さ**: サーバーレス環境での制約
  - 対策: 処理の分割、外部サービス活用
- **素材の著作権問題**: 商用利用可能素材の確保
  - 対策: 信頼できる無料素材サイトの活用

### 7.2 コストリスク
- **API使用料の増加**: 動画生成に伴うコスト増
  - 対策: 使用量監視、効率的なAPI利用

### 7.3 品質リスク
- **動画品質のばらつき**: 自動生成による品質の不安定性
  - 対策: テンプレート化、品質チェック機能

## 8. 成功指標

### 8.1 機能指標
- 動画生成成功率: 95%以上
- 処理時間: 音声5分あたり10分以内
- ユーザー満足度: 4.0/5.0以上

### 8.2 ビジネス指標
- 運用コスト: vrew使用時の50%以下
- 作業時間短縮: 従来の70%削減
- 動画品質: 手動作成と同等レベル

## 9. 今後の拡張可能性

- 多言語対応（英語、中国語等）
- リアルタイム動画生成
- AI音声合成との連携
- ソーシャルメディア自動投稿機能
- 動画分析・改善提案機能